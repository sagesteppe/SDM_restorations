---
title: "Generate Random Forest Models"
author: "steppe"
date: "2023-10-14"
output: html_document
---

```{r}
library(tidyverse)
library(terra)
library(sf)
source('functions.R')
```

```{r read in predictors}

p <- '/media/steppe/hdd/Geospatial_data/WesternPlantPredictors2'
paths <- list.dirs(p, recursive = T)
paths <- paths[2:length(paths)]
paths <- paths[! grepl('chelsa$|veg_cover$|soilgrids$|sand$|silt$|clay$|phh2o$|cfvo$', paths) ]

files <- lapply(paths, function(x){ file.path(x, list.files(x)) })
names(files) <- basename(paths)

layers <- lapply(files, vrt)
layers <- rast(layers)
names(layers) <- basename(paths)
```

```{r read in response}
p <- '../data/raw/occurrence/combined_records'
p2f <- file.path(p, list.files(p, pattern = '.shp$'))
train_dat <- lapply(p2f, sf::st_read, quiet = TRUE)
train_dat <- bind_rows(train_dat) %>% 
  st_transform(crs(layers))

abvi <- filter(train_dat, taxon == 'Abronia villosa')

abvi_test <- terra::extract(layers, abvi)


# identify a single component of each pair for usage. 
```


